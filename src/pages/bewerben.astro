---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Jetzt Bewerben">
  <section class="pt-40 pb-20 px-8 md:px-24">
    <p class="text-brand font-bold uppercase tracking-[0.3em] mb-4 text-xs italic">Karriere</p>
    <h1 class="text-[clamp(3rem,8vw,6rem)] font-black uppercase leading-[0.85] mb-12">
      Teil des <br />
      <span class="text-transparent stroke-black" style="-webkit-text-stroke: 1.5px black;">Teams werden.</span>
    </h1>
  </section>

  <section class="pb-32 px-8 md:px-24">
    <div class="max-w-4xl bg-slate-50 p-8 md:p-16 border border-slate-100">
      <form action="https://formspree.io/f/xdalynzd" method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-8">
        
        <div class="flex flex-col gap-2">
          <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400">Vor- & Nachname</label>
          <input type="text" name="name" required class="bg-transparent border-b-2 border-slate-200 py-3 focus:border-brand outline-none transition-colors font-bold uppercase text-sm" />
        </div>

        <div class="flex flex-col gap-2">
          <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400">E-Mail</label>
          <input type="email" name="email" required class="bg-transparent border-b-2 border-slate-200 py-3 focus:border-brand outline-none transition-colors font-bold uppercase text-sm" />
        </div>

        <div class="flex flex-col gap-2 md:col-span-2">
          <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400">Telefonnummer</label>
          <input 
            type="tel" 
            name="phone" 
            required 
            pattern="[+]{0,1}[0-9\s\-]{7,20}" 
            title="Gültiges Format: +49 123 456789"
            class="bg-transparent border-b-2 border-slate-200 py-3 focus:border-brand outline-none transition-colors font-bold uppercase text-sm" 
            placeholder="+49 176 12345678"
          />
        </div>

        <div class="flex flex-col gap-2 md:col-span-2">
          <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400">Bewerbung als:</label>
          <input 
            type="text" 
            id="job-input" 
            name="position" 
            readonly 
            class="bg-slate-100 border-b-2 border-slate-300 py-3 px-2 outline-none font-black uppercase text-sm text-slate-500 cursor-not-allowed" 
          />
          <p class="text-[9px] text-brand font-bold uppercase mt-1">* Diese Position wurde automatisch ausgewählt.</p>
        </div>

        <div class="md:col-span-2 bg-white p-8 border-2 border-dashed border-slate-200">
           <p class="text-[10px] font-bold uppercase tracking-widest text-brand mb-2">Wichtiger Hinweis</p>
           <p class="text-sm font-bold uppercase text-slate-600 leading-relaxed">
             Da unser System nur Kurzbewerbungen verarbeitet, senden Sie Ihren **Lebenslauf (PDF)** bitte separat an: 
             <a href="mailto:karriere@attar-service.de" class="text-black underline">karriere@attar-service.de</a>
           </p>
        </div>

        <div class="flex flex-col gap-2 md:col-span-2">
          <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400">Nachricht (Optional)</label>
          <textarea name="message" rows="3" class="bg-transparent border-b-2 border-slate-200 py-3 focus:border-brand outline-none transition-colors font-bold uppercase text-sm resize-none"></textarea>
        </div>

        <div class="md:col-span-2 pt-8">
          <button type="submit" class="w-full bg-black text-white py-6 font-black uppercase tracking-[0.2em] hover:bg-brand transition-all flex justify-between px-8 items-center group">
            Kurzbewerbung Absenden
            <span class="group-hover:translate-x-2 transition-transform">→</span>
          </button>
        </div>
      </form>
    </div>
  </section>
</Layout>

<script>
  // This script runs on the client to grab the 'job' from the URL
  const urlParams = new URLSearchParams(window.location.search);
  const jobTitle = urlParams.get('job');
  const jobInput = document.getElementById('job-input') as HTMLInputElement;

  if (jobTitle && jobInput) {
    jobInput.value = jobTitle.toUpperCase();
  } else if (jobInput) {
    jobInput.value = "INITIATIVBEWERBUNG";
    jobInput.readOnly = false; // Let them type if they came here directly
    jobInput.classList.remove('cursor-not-allowed', 'bg-slate-100');
  }
</script>